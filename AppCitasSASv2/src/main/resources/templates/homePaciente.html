<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
<meta charset="UTF-8">
<title>Home</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.2/css/bootstrap.min.css"
		th:href="@{/webjars/bootstrap/css/bootstrap.min.css}">
	<link rel="stylesheet" href="../static/css/estilo.css" th:href="@{/css/estilo.css}">
	<link rel="stylesheet" href="../static/css/menu.css" th:href="@{/css/menu.css}">
	<link rel="icon" href="../static/css/img/icono.png" th:href="@{/css/img/icono.png}">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js" th:src="@{/webjars/jquery/jquery.min.js}"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script th:src="@{/script/script.js}"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.2/js/bootstrap.min.js" th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
	<style>
        
		.parent {
			display: grid;
			grid-template-columns: repeat(4, 1fr);
			grid-template-rows: repeat(4, 1fr);
			grid-column-gap: 0px;
			grid-row-gap: 0px;
		}
			
		.div1 { grid-area: 1 / 1 / 3 / 4; }
		.div2 { grid-area: 1 / 4 / 5 / 5; }
		.div3 { grid-area: 3 / 3 / 5 / 4; }
		.div4 { grid-area: 3 / 1 / 5 / 3; }
	</style>
</head>

<body>
	<nav>
		<div class="menu m-2">
            <div class="logo">
                <i class="nav-link"><img th:src="@{/css/img/icono.png}" alt="imagen logo"></i>
                <a style="color: white; margin-top: 5px;" >AppCitasSAS</a>
            </div>
			<ul class="nav-links" style="margin-top: 15px;">
				<li><a style="color: white;" th:href="@{/}">Citas</a></li>
				<li><a style="color: white;" th:href="@{/}">Informes</a></li>
				<li><a style="color: white;" th:href="@{/}">Datos Personales</a></li>
				<li>
					<form th:action="@{/auth/logout}" method="post" id="logoutForm">
						<button type="button" class=""
							onclick="confirmarLogout()">Salir</button>
					</form>
				</li>				
			</ul>
		</div>
	</nav>
<br>
	<div class="parent">
		<div class="div1">
			<div class="card bg-light">
				<div class="card-header"><h3>Proximas Citas</h3></div>
				<div class="card-body">
	
					<h5 class="card-title text-center text-danger" th:if="${#lists.isEmpty(citas)}">No hay citas pendientes</h5>
					
					<table class="table table-striped table-bordered" th:if="${not #lists.isEmpty(citas)}">
						<thead class="thead-inverse">
							<tr>
								<th class="table-dark">fecha cita</th>
								<th class="table-dark">motivo</th>
								<th class="table-dark">estado</th>
								<th class="table-dark" sec:authorize="hasRole('ROLE_USER')"></th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="cita : ${citas}">
								<td th:text="${cita.fechaCita}"></td>
								<td th:text="${cita.motivoCita}"></td>
								<td th:text="${cita.estadoCita}"></td>
								<td sec:authorize="hasRole('ROLE_USER')">
	    							<a class="btn btn-danger" th:attr="data-id=${cita.idCita}" th:text="'Cancelar Cita'" onclick="confirmarEliminarCita(event)"></a>
								</td>
	
							</tr>
						</tbody>
					</table>
					<br>
					<h4 class="card-title" style="text-align: center;">
						<a sec:authorize="hasRole('ROLE_USER')" th:href="@{/privada/crearCita}" class="btn btn-dark">
							crear cita
						</a>
					</h4>
				</div>
			</div>
		</div>
		
		<div class="div2">
			<div class="card bg-light">
				<div class="card-header"><h3>Datos Personales</h3></div>	
				<div class="card-body" >	
						
				<div class="user-card-container">
				    <div class="user-card">
				        <!--<img class="user-image" src="/usuarios/{idPaciente}/imagen" alt="Imagen del usuario">-->
				        <div class="user-details">
							<br>
				            <h5 class="card-title" th:text="${paciente.nombreCompletoPaciente}" style="text-align: center;"></h5>
				            <br>
				            <dl class="user-info">
				                <dt>Email:</dt>
				                <dd th:text="${paciente.emailPaciente}"></dd>
				
				                <dt>DNI:</dt>
				                <dd th:text="${paciente.dniPaciente}"></dd>
				
				                <dt>Teléfono:</dt>
				                <dd th:text="${paciente.tlfPaciente}"></dd>
				
				                <dt>Dirección:</dt>
				                <dd th:text="${paciente.direccionPaciente}"></dd>
				            </dl>
				            <br>
				            <div class="btn-container text-center">
								<a class="btn btn-primary" th:href="@{/privada/editar-paciente/} + ${paciente.idPaciente}" th:text="'Modificar Datos'"></a>
							</div>									       
				        </div>
				    </div>
				</div>
			</div>
				
				
				
				
				<!-- Formulario para subir imagen -->
				<form action="/usuarios/{id}/imagen" method="post" enctype="multipart/form-data">
				    <input type="file" name="file" accept="image/*">
				    <button type="submit">Subir imagen</button>
				</form>
			</div>
		</div>
		
		<div class="div3">
	        <div class="card bg-light">
	            <div class="card-header"><h3>Informes</h3></div>
	            <div class="card-body">
	                <h5 class="card-title text-center text-danger" th:if="${#lists.isEmpty(informes)}">No hay Informes</h5>
	
	                <table class="table table-striped table-bordered" th:if="${not #lists.isEmpty(informes)}">
					    <thead class="thead-inverse">
					        <tr>
					            <th class="table-dark">Nombre Informe</th>
					            <th class="table-dark">Ver Informe</th>
					        </tr>
					    </thead>
					    <tbody id="informesTable">
					        <tr th:each="informe : ${informes}">
					            <td th:text="${informe.nombreInforme}"></td>
					            <td sec:authorize="hasRole('ROLE_USER')">
	    							<a class="btn btn-primary" th:href="@{/privada/ver-informe/} + ${informe.idInforme}" th:text="'Ver Informe'"></a>
								</td>
							</td>
					        </tr>
					    </tbody>
					</table>
	            </div>
	        </div>
		</div>
		
	    <div class="div4">
		    <div class="card bg-light">
		        <div class="card-header"><h3>Ultimo Informe</h3></div>
		        <div class="card-body" id="informeContent">
		            <h5 th:text="${informe != null ? informe.nombreInforme : ''}">Nombre:</h5>
		            <p th:text="${informe != null ? informe.descInforme : ''}">Descripción:</p>
		            <p th:text="${informe != null ? informe.fchInforme : ''}">Fecha:</p>
		        </div>
		    </div>
		</div>
	</div>
</body>

</html>